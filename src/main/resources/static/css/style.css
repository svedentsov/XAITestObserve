@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap');

/* --- Светлая тема (по умолчанию) --- */
:root {
    --color-background: #f9fafb;
    --color-panel-background: #ffffff;
    --color-border: #e5e7eb;
    --color-text-primary: #1f2937;
    --color-text-secondary: #6b7280;
    --color-accent: #3b82f6;
    --color-accent-hover: #2563eb;
    --color-accent-light: #dbeafe;
    --color-light-grey: #f3f4f6;

    --color-success: #16a34a;
    --color-failure: #ef4444;
    --color-skipped: #f97316;
    --color-success-background: #dcfce7;
    --color-failure-background: #fee2e2;
    --color-skipped-background: #ffedd5;
    --color-row-failure-background: rgba(254, 226, 226, 0.4);

    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 16px;
    --spacing-lg: 24px;
    --spacing-xl: 32px;

    --border-radius-sm: 4px;
    --border-radius-md: 8px;
    --border-radius-lg: 12px;
    --border-radius-pill: 9999px;

    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
    --shadow-inset: inset 0 2px 4px 0 rgba(0,0,0,0.05);
}

/* --- Тёмная тема --- */
html.dark-theme {
    --color-background: #111827;
    --color-panel-background: #1f2937;
    --color-border: #374151;
    --color-text-primary: #f9fafb;
    --color-text-secondary: #9ca3af;
    --color-accent: #60a5fa;
    --color-accent-hover: #93c5fd;
    --color-accent-light: #374151;
    --color-light-grey: #111827;

    --color-success: #4ade80;
    --color-failure: #f87171;
    --color-skipped: #fb923c;
    --color-success-background: #1c3d2e;
    --color-failure-background: #451a28;
    --color-skipped-background: #432c1b;
    --color-row-failure-background: rgba(69, 26, 40, 0.5);
}

*, *::before, *::after {
    box-sizing: border-box;
}

html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Roboto', 'Segoe UI', Arial, sans-serif;
    background-color: var(--color-background);
    color: var(--color-text-primary);
    line-height: 1.5;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    font-size: 15px;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* --- Header --- */
.app-header {
    background-color: var(--color-panel-background);
    padding: var(--spacing-sm) var(--spacing-lg);
    z-index: 100;
    border-bottom: 1px solid var(--color-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
    transition: background-color 0.3s ease, border-color 0.3s ease;
}
.header-content { display: flex; justify-content: space-between; align-items: center; width: 100%; }
.header-actions { display: flex; align-items: center; gap: var(--spacing-sm); }
.header-title { display: flex; align-items: center; gap: var(--spacing-sm); }
.header-title-text { font-size: 20px; font-weight: 500; margin: 0; color: var(--color-text-primary); }
.header-icon { color: var(--color-accent); font-size: 22px; }

/* --- Buttons & Theme Toggle --- */
.btn {
    border: 1px solid;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-md);
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: 14px;
    text-decoration: none;
    background-color: transparent;
}
.btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-sm); }
.btn:active { transform: translateY(0); box-shadow: var(--shadow-inset); }

.btn-primary { background-color: var(--color-accent); color: white; border-color: var(--color-accent); }
.btn-primary:hover { background-color: var(--color-accent-hover); border-color: var(--color-accent-hover); }

.btn.btn-danger { background-color: var(--color-failure); color: white; border-color: var(--color-failure); }
.btn.btn-danger:hover { background-color: #d03838; border-color: #d03838; }

.btn.btn-secondary {
    background-color: var(--color-text-secondary);
    color: white;
    border-color: var(--color-text-secondary);
}
.btn.btn-secondary:hover {
    background-color: var(--color-text-primary);
    border-color: var(--color-text-primary);
}

.theme-toggle-btn { background: none; border: 1px solid var(--color-border); cursor: pointer; width: 38px; height: 38px; border-radius: 50%; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; color: var(--color-text-secondary); transition: all 0.2s ease; }
.theme-toggle-btn:hover { background-color: var(--color-light-grey); border-color: var(--color-text-secondary); }
.theme-toggle-btn i { position: absolute; transition: transform 0.3s ease, opacity 0.3s ease; }
.theme-toggle-btn .fa-sun { transform: translateY(0) scale(1); opacity: 1; }
.theme-toggle-btn .fa-moon { transform: translateY(20px) scale(0.5); opacity: 0; }
html.dark-theme .theme-toggle-btn .fa-sun { transform: translateY(-20px) scale(0.5); opacity: 0; }
html.dark-theme .theme-toggle-btn .fa-moon { transform: translateY(0) scale(1); opacity: 1; }

/* --- Layout, Panels, Tabs --- */
.app-main { flex: 1; display: flex; min-height: 0; }
.container-fluid { width: 100%; height: 100%; display: flex; overflow: hidden; }
.left-panel { flex: 0 0 650px; background-color: var(--color-background); display: flex; flex-direction: column; overflow: hidden; border-right: 1px solid var(--color-border); transition: background-color 0.3s ease, border-color 0.3s ease; }
.right-panel { flex: 1; overflow-y: auto; padding: var(--spacing-lg); background-color: var(--color-background); }
.tabs { display: flex; flex-direction: column; height: 100%; }
.tab-buttons { display: flex; border-bottom: 1px solid var(--color-border); background-color: var(--color-panel-background); flex-shrink: 0; }
.tab-button { background-color: transparent; border: none; padding: 12px var(--spacing-lg); cursor: pointer; font-size: 15px; font-weight: 500; color: var(--color-text-secondary); border-bottom: 2px solid transparent; transition: all 0.2s ease; outline: none; flex-grow: 1; text-align: center; }
.tab-button:hover { color: var(--color-accent); }
.tab-button.active { color: var(--color-accent); border-bottom-color: var(--color-accent); }
.tab-content { display: none; flex: 1; flex-direction: column; overflow: hidden; }
.tab-content.active { display: flex; }

#overviewTabContent { padding: var(--spacing-md); }
#widgetsTabContent { overflow-y: auto; }

/* --- Filters & Search --- */
.filter-controls { display: flex; gap: var(--spacing-md); margin-bottom: var(--spacing-md); align-items: center; }
.search-wrapper { position: relative; flex-grow: 1; }
.search-wrapper i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--color-text-secondary); }
#search-input { width: 100%; padding: 8px 12px 8px 36px; border-radius: var(--border-radius-md); border: 1px solid var(--color-border); background-color: var(--color-panel-background); color: var(--color-text-primary); font-size: 14px; transition: all 0.2s ease; }
#search-input:focus { border-color: var(--color-accent); box-shadow: 0 0 0 2px var(--color-accent-light); outline: none; }
.status-filters { display: flex; background-color: var(--color-light-grey); border-radius: var(--border-radius-md); padding: 4px; border: 1px solid var(--color-border); }
.filter-btn { background: transparent; border: none; padding: 4px 12px; border-radius: var(--border-radius-sm); cursor: pointer; color: var(--color-text-secondary); font-weight: 500; transition: all 0.2s ease; }
.filter-btn.active { background-color: var(--color-panel-background); color: var(--color-accent); box-shadow: var(--shadow-sm); }
.filter-btn:not(.active):hover { color: var(--color-text-primary); }
.filter-btn i { font-size: 14px; }
.filter-btn[data-status="PASSED"].active { color: var(--color-success); }
.filter-btn[data-status="FAILED"].active { color: var(--color-failure); }
.filter-btn[data-status="SKIPPED"].active { color: var(--color-skipped); }

/* --- Test List --- */
.test-list-wrapper { flex: 1; overflow-y: auto; border: 1px solid var(--color-border); border-radius: var(--border-radius-lg); background-color: var(--color-panel-background); }
.test-list-table { width: 100%; border-collapse: collapse; table-layout: fixed; }
.test-list-table thead th, .test-row td { padding: 12px var(--spacing-md); vertical-align: middle; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.test-list-table thead th { position: sticky; top: 0; background-color: var(--color-panel-background); text-align: left; font-weight: 500; font-size: 13px; color: var(--color-text-secondary); border-bottom: 1px solid var(--color-border); z-index: 1; }
.test-list-table .env-col { width: 110px; }
.test-list-table .version-col { width: 100px; }
.test-list-table .time-col { width: 160px; }
.test-row { cursor: pointer; border-bottom: 1px solid var(--color-border); transition: background-color 0.2s ease; }
.test-row:last-child { border-bottom: none; }
.test-row:hover { background-color: var(--color-light-grey); }
.test-row[data-status="FAILED"] { background-color: var(--color-row-failure-background); }
.test-row[data-status="FAILED"] .test-method-cell { font-weight: 500; color: var(--color-failure); }
.test-row.selected { background-color: var(--color-accent-light) !important; }
.test-row.selected .test-method-cell { color: var(--color-accent-hover); font-weight: 500; }
html.dark-theme .test-row.selected .test-method-cell { color: var(--color-text-primary); }
.badge { display: inline-block; padding: 3px var(--spacing-sm); border-radius: var(--border-radius-pill); font-size: 12px; font-weight: 500; background-color: var(--color-light-grey); color: var(--color-text-secondary); }

/* --- Right Panel Details --- */
.detail-block { margin-bottom: var(--spacing-lg); background-color: var(--color-panel-background); border-radius: var(--border-radius-lg); padding: var(--spacing-lg); border: 1px solid var(--color-border); transition: all 0.3s ease; }
.detail-block h3 { margin-top: 0; font-size: 16px; font-weight: 500; display: flex; align-items: center; gap: var(--spacing-sm); color: var(--color-text-primary); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-sm); border-bottom: 1px solid var(--color-border); }
.info-grid-3col { display: grid; gap: var(--spacing-sm) var(--spacing-md); grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
@media (min-width: 1200px) { .info-grid-3col { grid-template-columns: repeat(3, 1fr); } }
.info-grid-3col p { margin: 0; word-break: break-word; }
.info-grid-3col p strong { color: var(--color-text-secondary); font-weight: 400; }
.status-badge { padding: 4px 10px; border-radius: var(--border-radius-pill); font-size: 13px; font-weight: 500; display: inline-block; }
.status-badge.status-passed { background-color: var(--color-success-background); color: var(--color-success); }
.status-badge.status-failed { background-color: var(--color-failure-background); color: var(--color-failure); }
.status-badge.status-skipped, .status-badge.status-broken { background-color: var(--color-skipped-background); color: var(--color-skipped); }

.tags-container { display: flex; flex-wrap: wrap; gap: var(--spacing-sm); }
.tag-badge { background-color: var(--color-accent-light); color: var(--color-accent-hover); padding: 4px 10px; border-radius: var(--border-radius-pill); font-size: 13px; font-weight: 500; }
html.dark-theme .tag-badge { background-color: var(--color-border); color: var(--color-accent); }

.artifacts-container { display: flex; flex-wrap: wrap; gap: var(--spacing-md); }
.artifact-link { display: inline-flex; align-items: center; gap: var(--spacing-sm); text-decoration: none; background-color: var(--color-light-grey); padding: var(--spacing-sm) var(--spacing-md); border-radius: var(--border-radius-md); color: var(--color-text-secondary); font-weight: 500; transition: all 0.2s ease; border: 1px solid var(--color-border); }
.artifact-link:hover { background-color: var(--color-accent-light); color: var(--color-accent-hover); border-color: var(--color-accent); transform: translateY(-1px); box-shadow: var(--shadow-sm); }
html.dark-theme .artifact-link:hover { background-color: var(--color-border); color: var(--color-accent); border-color: var(--color-accent); }

/* --- AI Analysis & Feedback --- */
.analysis-result-item { border-top: 1px solid var(--color-border); padding-top: var(--spacing-md); margin-top: var(--spacing-md); }
.analysis-result-item:first-child { border-top: none; padding-top: 0; margin-top: 0; }
.feedback-actions { margin-top: var(--spacing-md); display: flex; gap: var(--spacing-sm); align-items: center; }
.feedback-prompt { font-size: 14px; color: var(--color-text-secondary); }
.feedback-btn { background: none; border: 1px solid var(--color-border); color: var(--color-text-secondary); padding: var(--spacing-xs) var(--spacing-sm); border-radius: var(--border-radius-md); cursor: pointer; display: flex; align-items: center; gap: var(--spacing-xs); font-size: 13px; transition: all 0.2s ease; }
.feedback-btn:hover { background-color: var(--color-light-grey); border-color: var(--color-text-secondary); }
.feedback-actions.voted .feedback-btn { pointer-events: none; opacity: 0.7; }
.feedback-actions.voted .feedback-btn.selected-true { background-color: var(--color-success-background); border-color: var(--color-success); color: var(--color-success); opacity: 1; }
.feedback-actions.voted .feedback-btn.selected-false { background-color: var(--color-failure-background); border-color: var(--color-failure); color: var(--color-failure); opacity: 1; }

/* --- Execution Path Timeline --- */
.execution-path-visualizer { list-style: none; padding: 0; margin: 0; position: relative; }
.execution-path-visualizer::before { content: ''; position: absolute; left: 12px; top: 8px; bottom: 8px; width: 2px; background-color: var(--color-border); }
.execution-path-visualizer li { position: relative; padding-left: 36px; padding-bottom: var(--spacing-lg); }
.execution-path-visualizer li:last-child { padding-bottom: 0; }
.execution-path-visualizer li::before { content: ''; position: absolute; left: 5px; top: 5px; width: 16px; height: 16px; border-radius: 50%; background-color: var(--color-panel-background); border: 2px solid; z-index: 1; transition: all 0.2s ease; }
.step-header { display: flex; flex-wrap: wrap; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-xs); font-size: 16px; font-weight: 500; }
.step-details { background: var(--color-light-grey); padding: var(--spacing-sm) var(--spacing-md); border-radius: var(--border-radius-md); font-size: 14px; }
.step-details p { margin: 0 0 var(--spacing-xs) 0; word-break: break-all; }
.execution-path-visualizer li.step-success::before { border-color: var(--color-success); }
.execution-path-visualizer li.step-success .step-header i { color: var(--color-success); }
.execution-path-visualizer li.step-failure::before { border-color: var(--color-failure); background-color: var(--color-failure); }
.execution-path-visualizer li.step-failure .step-header i { color: var(--color-failure); }
.execution-path-visualizer li.failed-step-highlight .step-details { border: 1px solid var(--color-failure); }
.step-error-message { color: var(--color-failure); font-weight: 500; }
pre { background-color: #111827; color: #d1d5db; border: 1px solid var(--color-border); padding: var(--spacing-md); border-radius: var(--border-radius-md); overflow-x: auto; font-family: 'Roboto Mono', monospace; font-size: 13px; }
html:not(.dark-theme) pre { background-color: var(--color-light-grey); color: var(--color-text-primary); }

/* --- Widgets & Charts --- */
.stats-section { padding: var(--spacing-md); }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: var(--spacing-md); margin-bottom: var(--spacing-md); }
.stats-card { background-color: var(--color-panel-background); padding: var(--spacing-md); border-radius: var(--border-radius-lg); text-align: center; border: 1px solid var(--color-border); }
.stats-card h4 { margin: 0 0 var(--spacing-xs) 0; font-size: 13px; color: var(--color-text-secondary); font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.stats-card p { margin: 0; font-size: 24px; font-weight: 700; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.stats-card.status-passed p { color: var(--color-success); }
.stats-card.status-failed p { color: var(--color-failure); }
.stats-card.status-skipped p { color: var(--color-skipped); }
.graphs-section { padding: var(--spacing-md); display: grid; grid-template-columns: 1fr; gap: var(--spacing-md); }
.graphs-card { background-color: var(--color-panel-background); border-radius: var(--border-radius-lg); border: 1px solid var(--color-border); padding: var(--spacing-md); display: flex; flex-direction: column; }
.graphs-card h4 { margin: 0 0 var(--spacing-md) 0; font-size: 14px; font-weight: 500; flex-shrink: 0; }
.chart-container { position: relative; flex-grow: 1; min-height: 280px; }

/* --- Placeholders, Spinners, Toasts --- */
.placeholder-content, .loading-message, #no-results-placeholder { text-align: center; margin-top: 100px; color: var(--color-text-secondary); padding: var(--spacing-lg); }
.placeholder-icon { font-size: 48px; margin-bottom: var(--spacing-md); }
.toast-container { position: fixed; bottom: var(--spacing-lg); right: var(--spacing-lg); z-index: 1100; display: flex; flex-direction: column; gap: var(--spacing-sm); }
.toast { background-color: var(--color-panel-background); color: var(--color-text-primary); padding: var(--spacing-md); border-radius: var(--border-radius-md); box-shadow: var(--shadow-md); opacity: 0; transform: translateY(20px); transition: all 0.3s ease; display: flex; align-items: center; gap: var(--spacing-sm); border-left: 4px solid; min-width: 300px; }
.toast.show { opacity: 1; transform: translateY(0); }
.toast.success { border-color: var(--color-success); }
.toast.error { border-color: var(--color-failure); }
.toast.info { border-color: var(--color-accent); }

/* --- Responsive --- */
@media (max-width: 1200px) { .left-panel { flex: 0 0 550px; } }
@media (max-width: 992px) { .header-content { flex-direction: column; align-items: flex-start; gap: var(--spacing-sm); } .header-actions { width: 100%; justify-content: flex-end; } }
@media (max-width: 768px) { .left-panel { flex: 1 1 100%; border-right: none; padding: var(--spacing-sm); } .right-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1000; padding-top: 60px; } body.show-details-on-mobile .right-panel { display: block; } body.show-details-on-mobile .left-panel { display: none; } .filter-controls { flex-direction: column; gap: var(--spacing-sm); align-items: stretch; } .test-list-wrapper { border-radius: 0; } }
